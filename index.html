<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MILIVYATAN â€“ IRL Stream Banner</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Orbitron:wght@700;900&family=Cinzel:wght@900&family=Russo+One&family=Black+Han+Sans&family=Exo+2:wght@900&family=Teko:wght@700&family=Chakra+Petch:wght@700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-1  VARIABLES & HARD RESET
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --accent:        #00ffa3;
  --outline:       #00ffa3;
  --text-col:      #0a0a0a;
  --glow:          #00ffa3;
  --brad:          8px;
  --bw:            1.5px;
  --banner-w:      600px;   /* measured at runtime â€” see Â§JS-MEASURE */
  --font:          'Bebas Neue', sans-serif;
  --donation-gold: #ffd700;
  --glass-border:  rgba(255,255,255,0.22);
  --glass-inner:   rgba(0,255,163,0.07);
}
* { margin:0; padding:0; box-sizing:border-box; }

/* Fixed canvas size â€” StreamElements requires explicit pixel dimensions */
html, body {
  width:var(--banner-w); height:100px;
  overflow:hidden; background:transparent;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-2  BANNER SHELL â€” FIXED 600Ã—100
   Shape morphing = border-radius only.
   Size never changes. No fit-content, no auto height.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#banner {
  position:relative;
  width:var(--banner-w); height:100px;
  display:flex; align-items:center;
  overflow:hidden;

  /* glass â€” background set by glassTween rAF */
  background: rgba(12,12,12,0.52);
  backdrop-filter:    blur(16px) saturate(200%) brightness(0.92);
  -webkit-backdrop-filter: blur(16px) saturate(200%) brightness(0.92);

  border-radius: var(--brad);
  border:        var(--bw) solid var(--glass-border);

  box-shadow:
    0 0 24px  color-mix(in srgb, var(--glow) 36%, transparent),
    0 0 64px  color-mix(in srgb, var(--glow) 9%,  transparent),
    inset 0  1px 0   rgba(255,255,255,0.17),
    inset 0 -1px 0   rgba(0,0,0,0.28),
    inset 0  0  36px var(--glass-inner),
    inset 2px 2px 8px rgba(255,255,255,0.04),
    inset -2px -2px 8px rgba(0,0,0,0.16);

  will-change: border-radius, box-shadow;
  transition:
    border-radius 700ms cubic-bezier(.22,1,.36,1),
    border-color  700ms cubic-bezier(.22,1,.36,1),
    box-shadow    700ms cubic-bezier(.22,1,.36,1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-CANVAS â€” 2 canvases only (geo+particles merged logic)
   coin-cv kept for donation mode, liquid-cv for blobs
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#bg-cv, #liquid-cv, #coin-cv {
  position:absolute; top:0; left:0;
  width:var(--banner-w); height:100px;
  pointer-events:none;
}
#bg-cv     { z-index:1; opacity:.22; }
#liquid-cv { z-index:3; opacity:0; mix-blend-mode:screen;
             transition:opacity 500ms cubic-bezier(.22,1,.36,1); }
#coin-cv   { z-index:4; opacity:0; transition:opacity 500ms cubic-bezier(.22,1,.36,1); }

#scanlines {
  position:absolute; inset:0; z-index:5; pointer-events:none;
  background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.07) 2px,rgba(0,0,0,.07) 4px);
  opacity:0; transition:opacity 800ms cubic-bezier(.22,1,.36,1);
}

#drip {
  position:absolute; left:-24px; top:0; bottom:0; width:28px;
  background:var(--accent); border-radius:0 0 50% 50%;
  z-index:6; opacity:0; transform:scaleX(0); transform-origin:left;
}

#rgb-ghost {
  position:absolute; inset:0; z-index:16;
  pointer-events:none; opacity:0; mix-blend-mode:screen;
}

/* â”€â”€ Platform mini-tab (shared, content changed by JS) â”€â”€ */
#plat-tab {
  position:absolute; top:-1px; left:68px;
  font-family:'Orbitron',monospace; font-size:6.5px; font-weight:900;
  letter-spacing:2px; padding:2px 9px; border-radius:0 0 5px 5px;
  opacity:0; z-index:14; text-transform:uppercase;
  transition:opacity 600ms cubic-bezier(.22,1,.36,1);
  pointer-events:none; white-space:nowrap;
  /* colours set by JS per platform */
  background:#53fc18; color:#000;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-3  ICON PANEL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#icon-wrap {
  position:relative; z-index:10; flex-shrink:0;
  width:84px; height:100%;
  display:flex; align-items:center; justify-content:center;
  padding:0 4px 0 10px;
}
#icon-bg {
  position:absolute; inset:8px 5px; border-radius:10px;
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.14);
  backdrop-filter:blur(6px); -webkit-backdrop-filter:blur(6px);
  animation:borderBreath 3.6s cubic-bezier(.45,0,.55,1) infinite;
  transition:border-radius 700ms cubic-bezier(.22,1,.36,1);
}
#icon-inner {
  position:relative; z-index:2; width:48px; height:48px;
  display:flex; align-items:center; justify-content:center;
  animation:iconBob 3.5s cubic-bezier(.45,0,.55,1) infinite;
}
.sicon {
  position:absolute; width:36px; height:36px; object-fit:contain;
  filter:drop-shadow(0 0 8px var(--glow)) drop-shadow(0 2px 5px rgba(0,0,0,.6)) brightness(1.2);
  opacity:0; transform:scale(.6) rotate(-20deg);
}
.sicon.active { animation:iconIn  .54s cubic-bezier(.34,1.56,.64,1) forwards; }
.sicon.exit   { animation:iconOut .40s cubic-bezier(.22,1,.36,1)    forwards; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-4  TEXT ZONE â€” fixed height, flex column
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#text-zone {
  position:relative; z-index:10; flex:1;
  height:100%;
  display:flex; flex-direction:column; justify-content:center;
  padding:0 10px 0 4px;
  /* slight clipping guard for letter anims */
  overflow:hidden;
}
#handle { display:flex; align-items:baseline; gap:0; }

.lt {
  display:inline-block;
  font-family:var(--font); font-size:46px; font-weight:900;
  color:var(--text-col); text-transform:uppercase; letter-spacing:.02em;
  -webkit-text-stroke:1.5px var(--outline);
  text-shadow:
    0 1px 0  rgba(255,255,255,0.55),
    0 2px 4px rgba(0,0,0,0.55),
    0 0  8px  color-mix(in srgb, var(--glow) 28%, transparent);
  transition:
    color           500ms cubic-bezier(.22,1,.36,1),
    text-shadow     550ms cubic-bezier(.22,1,.36,1),
    -webkit-text-stroke 500ms cubic-bezier(.22,1,.36,1),
    filter          400ms cubic-bezier(.22,1,.36,1),
    transform       600ms cubic-bezier(.22,1.4,.36,1);
  will-change:transform;
}

#sub-lbl {
  font-family:'Orbitron',monospace; font-size:7.5px;
  letter-spacing:3px; text-transform:uppercase;
  color:var(--accent); margin-top:3px;
  opacity:.82;
  transition:color 500ms cubic-bezier(.22,1,.36,1), opacity 400ms cubic-bezier(.22,1,.36,1);
  white-space:nowrap; overflow:hidden;
}

/* â”€â”€ Follow button â€” bottom-anchored, below handle text â”€â”€ */
#follow-btn {
  position:absolute;
  /* Anchored to bottom of text-zone, not vertically centered */
  bottom:8px; right:12px;
  z-index:12; font-family:'Orbitron',monospace; font-size:6px;
  letter-spacing:2px; text-transform:uppercase;
  color:#000; background:var(--accent);
  border:none; border-radius:4px;
  padding:4px 10px; cursor:pointer;
  opacity:0; pointer-events:none;
  transition:opacity 500ms cubic-bezier(.22,1,.36,1), transform 400ms cubic-bezier(.34,1.56,.64,1);
  box-shadow:0 0 10px var(--glow);
}
#follow-btn.vis    { opacity:1; pointer-events:auto; }
#follow-btn:active { transform:scale(.88); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-5  DONATION PANEL â€” absolute overlay (fixed size)
   Width/height = banner, so it never affects layout.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#donation-panel {
  position:absolute; inset:0; z-index:20;
  display:flex; align-items:center;
  background:rgba(22,8,0,0.72);
  backdrop-filter:blur(18px) saturate(180%);
  -webkit-backdrop-filter:blur(18px) saturate(180%);
  border-radius:inherit;
  overflow:hidden;
  opacity:0; pointer-events:none;
  transition:opacity 600ms cubic-bezier(.22,1,.36,1);
}
#donation-panel.vis { opacity:1; pointer-events:auto; }

#qr-wrap {
  flex-shrink:0; width:80px; height:100%;
  display:flex; align-items:center; justify-content:center;
  position:relative; z-index:2; padding:0 4px 0 12px;
}
#qr-img {
  width:56px; height:56px; border-radius:6px;
  border:2px solid var(--donation-gold);
  box-shadow:0 0 16px var(--donation-gold),0 0 40px color-mix(in srgb,var(--donation-gold) 26%,transparent);
  animation:qrPulse 2.4s cubic-bezier(.45,0,.55,1) infinite;
}
#don-text {
  flex:1; padding:8px 8px 0 4px;
  display:flex; flex-direction:column; justify-content:center;
  position:relative; z-index:2;
}
#don-title {
  font-family:'Orbitron',monospace; font-size:11px; font-weight:900;
  letter-spacing:2px; text-transform:uppercase; color:var(--donation-gold);
  text-shadow:0 0 10px var(--donation-gold),0 0 24px var(--donation-gold);
  animation:donTitlePulse 1.8s cubic-bezier(.45,0,.55,1) infinite;
  white-space:nowrap;
}
#don-sub {
  font-family:'Chakra Petch',sans-serif; font-size:7px;
  letter-spacing:1.2px; text-transform:uppercase;
  color:#ffffffcc; margin-top:4px; white-space:nowrap;
}
#don-sub span { color:var(--donation-gold); font-weight:700; }
#don-marquee {
  position:absolute; bottom:0; left:0; right:0; height:12px;
  background:rgba(255,215,0,.09); border-top:1px solid rgba(255,215,0,.16);
  overflow:hidden; display:flex; align-items:center;
}
#don-marquee-inner {
  white-space:nowrap;
  font-family:'Orbitron',monospace; font-size:6.5px; letter-spacing:2px;
  color:var(--donation-gold); text-transform:uppercase;
  animation:marqueeScroll 14s linear infinite;
}
.money-drop {
  position:absolute; top:-20px; font-size:11px;
  animation:moneyFall 2.2s cubic-bezier(.22,1,.36,1) infinite;
  pointer-events:none; z-index:5; user-select:none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§CSS-6  KEYFRAMES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes iconIn {
  0%   { opacity:0; transform:scale(.5) rotate(-28deg) translateY(12px); }
  60%  { opacity:1; transform:scale(1.08) rotate(3deg) translateY(-2px); }
  80%  { transform:scale(.96) rotate(-1deg) translateY(1px); }
  100% { opacity:1; transform:scale(1) rotate(0) translateY(0); }
}
@keyframes iconOut {
  0%   { opacity:1; transform:scale(1) rotate(0); }
  100% { opacity:0; transform:scale(.35) rotate(26deg) translateY(-10px); }
}
@keyframes iconBob {
  0%,100% { transform:translateY(0) rotate(0); }
  32%     { transform:translateY(-5px) rotate(1.6deg); }
  66%     { transform:translateY(3px)  rotate(-1.2deg); }
}
@keyframes borderBreath {
  0%,100% { box-shadow:0 0 8px var(--glow),inset 0 0 12px rgba(0,0,0,.22); }
  50%     { box-shadow:0 0 24px var(--glow),0 0 44px color-mix(in srgb,var(--glow) 18%,transparent),inset 0 0 12px rgba(0,0,0,.22); }
}
@keyframes ltBounce {
  0%   { transform:translateY(0) scale(1); }
  28%  { transform:translateY(-15px) scale(1.18); }
  54%  { transform:translateY(4px) scale(.93); }
  74%  { transform:translateY(-6px) scale(1.06); }
  90%  { transform:translateY(2px) scale(.98); }
  100% { transform:translateY(0) scale(1); }
}
@keyframes ltPop {
  0%   { transform:scale(1); }
  38%  { transform:scale(1.46) rotate(-4deg); }
  68%  { transform:scale(.87) rotate(2deg); }
  100% { transform:scale(1) rotate(0); }
}
@keyframes ltFlicker {
  0%,100% { opacity:1; }
  14% { opacity:.55; } 20% { opacity:1; }
  48% { opacity:.62; } 55% { opacity:1; }
  78% { opacity:.50; } 84% { opacity:1; }
}
@keyframes liquidWarp {
  0%   { transform:translate(0,0) skewX(0deg) skewY(0deg); filter:blur(0px) hue-rotate(0deg); }
  12%  { transform:translate(-4px,2px) skewX(4deg) skewY(.5deg); filter:blur(1.5px) hue-rotate(45deg); }
  28%  { transform:translate(5px,-3px) skewX(-4deg) skewY(-.7deg); filter:blur(2px) hue-rotate(-55deg); }
  46%  { transform:translate(-3px,4px) skewX(3deg) skewY(.4deg); filter:blur(1px) hue-rotate(130deg); }
  64%  { transform:translate(3px,-2px) skewX(-3deg) skewY(-.3deg); filter:blur(1.5px) hue-rotate(190deg); }
  80%  { transform:translate(-1px,2px) skewX(1.5deg) skewY(.2deg); filter:blur(.4px) hue-rotate(20deg); }
  100% { transform:translate(0,0) skewX(0deg) skewY(0deg); filter:blur(0px) hue-rotate(0deg); }
}
@keyframes ltFadeIn {
  from { opacity:0; transform:translateX(-10px) scale(.93); }
  to   { opacity:1; transform:translateX(0) scale(1); }
}
@keyframes dripIn {
  0%   { transform:scaleX(0); opacity:1; left:-24px; }
  65%  { transform:scaleX(1); opacity:1; left:0; }
  100% { transform:scaleX(1); opacity:0; left:0; }
}
@keyframes rgbSplitWave {
  0%   { transform:translate(0,0); opacity:0; }
  18%  { transform:translate(5px,0); opacity:.20; background:rgba(255,0,80,.14); }
  38%  { transform:translate(-5px,0); opacity:.16; background:rgba(0,255,200,.12); }
  58%  { transform:translate(0,4px); opacity:.12; background:rgba(255,220,0,.08); }
  78%  { transform:translate(3px,-2px); opacity:.07; }
  100% { transform:translate(0,0); opacity:0; }
}
@keyframes qrPulse {
  0%,100% { box-shadow:0 0 14px var(--donation-gold),0 0 36px color-mix(in srgb,var(--donation-gold) 25%,transparent); }
  50%     { box-shadow:0 0 26px var(--donation-gold),0 0 64px color-mix(in srgb,var(--donation-gold) 44%,transparent); }
}
@keyframes donTitlePulse {
  0%,100% { text-shadow:0 0 10px var(--donation-gold),0 0 22px var(--donation-gold); }
  50%     { text-shadow:0 0 18px var(--donation-gold),0 0 42px var(--donation-gold),0 0 64px #ff9500; }
}
@keyframes marqueeScroll {
  0%   { transform:translateX(var(--banner-w)); }
  100% { transform:translateX(-100%); }
}
@keyframes moneyFall {
  0%   { transform:translateY(-20px) rotate(0deg) scale(1); opacity:1; }
  80%  { opacity:1; }
  100% { transform:translateY(105px) rotate(370deg) scale(.5); opacity:0; }
}
@keyframes donEnter {
  from { opacity:0; filter:blur(4px); }
  to   { opacity:1; filter:blur(0px); }
}
</style>
</head>
<body>
<div id="banner">
  <!-- 2 draw surfaces: bg-cv (geo+particles unified), liquid-cv, coin-cv -->
  <canvas id="bg-cv"     width="600" height="100"></canvas>
  <canvas id="liquid-cv" width="600" height="100"></canvas>
  <canvas id="coin-cv"   width="600" height="100"></canvas>

  <div id="scanlines"></div>
  <div id="drip"></div>
  <!-- unified platform tab â€” content+color set by JS -->
  <div id="plat-tab">KICK</div>
  <div id="rgb-ghost"></div>

  <div id="icon-wrap">
    <div id="icon-bg"></div>
    <div id="icon-inner"><!-- icons injected by JS --></div>
  </div>

  <div id="text-zone">
    <div id="handle"><!-- letters injected by JS --></div>
    <div id="sub-lbl">LIVE FROM LAGOS</div>
    <button id="follow-btn">+ FOLLOW</button>
  </div>

  <!-- Donation panel is absolute overlay â€” never affects layout -->
  <div id="donation-panel">
    <div id="qr-wrap">
      <img id="qr-img" src="https://i.imgur.com/o7uxXZf.png" alt="Donate QR">
    </div>
    <div id="don-text">
      <div id="don-title">ğŸ’° SUPPORT MILI</div>
      <div id="don-sub">Scan QR or <span>donate a dollar</span> â€” every bit counts!</div>
    </div>
    <div id="don-marquee">
      <div id="don-marquee-inner">
        ğŸ’µ DONATE NOW &nbsp;â€¢&nbsp; ğŸª™ SUPPORT THE JOURNEY &nbsp;â€¢&nbsp; ğŸ’¸ EVERY DOLLAR MOVES THE NEEDLE &nbsp;â€¢&nbsp; ğŸ“¡ LIVE FROM THE STREETS &nbsp;â€¢&nbsp; â­ BE PART OF THE RISE &nbsp;â€¢&nbsp; ğŸ’µ DONATE NOW &nbsp;â€¢&nbsp;
      </div>
    </div>
  </div>
</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-A  CONSTANTS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const ROOT   = document.documentElement;
const BANNER = document.getElementById('banner');
let BW = 600; const BH = 100; // BW updated by Â§JS-MEASURE after font load

const sv = (k,v) => ROOT.style.setProperty(k,v);

/* â”€â”€ Color helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function hexToLinear(c){ c/=255; return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4); }
function rgbLum(r,g,b){ return .2126*hexToLinear(r)+.7152*hexToLinear(g)+.0722*hexToLinear(b); }
function parseColor(s){
  s=s.trim();
  if(s.startsWith('#')){ let h=s.slice(1); if(h.length===3)h=h[0]+h[0]+h[1]+h[1]+h[2]+h[2]; return{r:parseInt(h.slice(0,2),16),g:parseInt(h.slice(2,4),16),b:parseInt(h.slice(4,6),16)}; }
  const m=s.match(/\d+/g); return m?{r:+m[0],g:+m[1],b:+m[2]}:{r:0,g:0,b:0};
}
function lerpN(a,b,t){ return a+(b-a)*t; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-GLASS  CONTINUOUS GLASS TWEEN
   Interpolates rgba background + blur + caustic every rAF frame.
   Speed 0.04 â‰ˆ ~30 frames to reach target â€” smooth, not instant.
   gv() removed from hot loop; cached accent parsed once per change.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const glass = {
  cur: {r:12,g:12,b:12,a:.52,blur:16,iR:0,iG:255,iB:163,iA:.07},
  tgt: {r:12,g:12,b:12,a:.52,blur:16,iR:0,iG:255,iB:163,iA:.07},
  acc: {r:0,g:255,b:163},   // current accent rgb â€” cached
  sp: 0.04
};

function glassFrame(){
  const s=glass.sp, c=glass.cur, t=glass.tgt;
  c.r    =lerpN(c.r,   t.r,   s);
  c.g    =lerpN(c.g,   t.g,   s);
  c.b    =lerpN(c.b,   t.b,   s);
  c.a    =lerpN(c.a,   t.a,   s);
  c.blur =lerpN(c.blur,t.blur,s);
  c.iR   =lerpN(c.iR,  t.iR,  s*.7);
  c.iG   =lerpN(c.iG,  t.iG,  s*.7);
  c.iB   =lerpN(c.iB,  t.iB,  s*.7);
  c.iA   =lerpN(c.iA,  t.iA,  s*.7);

  const r=c.r|0,g=c.g|0,b=c.b|0;
  const iR=c.iR|0,iG=c.iG|0,iB=c.iB|0;
  const {r:aR,g:aG,b:aB}=glass.acc;

  BANNER.style.background=`rgba(${r},${g},${b},${c.a.toFixed(3)})`;
  BANNER.style.backdropFilter=`blur(${c.blur.toFixed(1)}px) saturate(200%) brightness(0.92)`;
  BANNER.style.webkitBackdropFilter=BANNER.style.backdropFilter;
  BANNER.style.boxShadow=`
    0 0 24px rgba(${aR},${aG},${aB},.36),
    0 0 64px rgba(${aR},${aG},${aB},.09),
    inset 0 1px 0 rgba(255,255,255,${(.17-c.a*.08).toFixed(3)}),
    inset 0 -1px 0 rgba(0,0,0,.26),
    inset 0 0 36px rgba(${iR},${iG},${iB},${c.iA.toFixed(3)}),
    inset 2px 2px 8px rgba(255,255,255,.04),
    inset -2px -2px 8px rgba(0,0,0,.14)`;
}

function setGlassTarget(accHex, overRgb){
  const ac=parseColor(accHex||'#00ffa3');
  glass.acc={r:ac.r,g:ac.g,b:ac.b};
  let r,g,b,a;
  if(overRgb){ [r,g,b,a]=overRgb; }
  else{
    const lum=rgbLum(ac.r,ac.g,ac.b);
    r=(ac.r*.10)|0; g=(ac.g*.10)|0; b=(ac.b*.10)|0;
    a=Math.min(.76,Math.max(.30,.30+lum*.56));
  }
  glass.tgt.r=r; glass.tgt.g=g; glass.tgt.b=b; glass.tgt.a=a;
  glass.tgt.blur=rgbLum(ac.r,ac.g,ac.b)>.5?11:17;
  glass.tgt.iR=ac.r; glass.tgt.iG=ac.g; glass.tgt.iB=ac.b; glass.tgt.iA=.08;
  sv('--glass-border',`rgba(${Math.min(255,r*3+165)},${Math.min(255,g*3+165)},${Math.min(255,b*3+165)},0.22)`);
  sv('--glass-inner', `rgba(${ac.r},${ac.g},${ac.b},0.07)`);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-MICRO  MEMBRANE INSTABILITY â€” border-radius only
   No scale, no size change. Only subtle border-radius fluctuation.
   Low frequency: 3â€“7 seconds between pulses.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function microDeform(){
  const cur=parseFloat(getComputedStyle(BANNER).borderRadius)||8;
  const target=Math.max(2, cur+(Math.random()-.5)*7);
  const dur=700+Math.random()*500;
  BANNER.style.transition=`border-radius ${dur}ms cubic-bezier(.22,1.4,.36,1), border-color 700ms cubic-bezier(.22,1,.36,1), box-shadow 700ms cubic-bezier(.22,1,.36,1)`;
  BANNER.style.borderRadius=`${target}px`;
  setTimeout(()=>{
    BANNER.style.borderRadius=`${cur}px`;
    setTimeout(()=>{ BANNER.style.transition='border-radius 700ms cubic-bezier(.22,1,.36,1), border-color 700ms cubic-bezier(.22,1,.36,1), box-shadow 700ms cubic-bezier(.22,1,.36,1)'; },dur+20);
  },dur);
  setTimeout(microDeform, 3000+Math.random()*4000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-B  ICON ROTATION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const ICONS=[
  {id:'yt', label:'YouTube', url:'https://cdn.simpleicons.org/youtube/FF0000',  col:'#ff3030', tabBg:'#ff0000', tabTxt:'#fff', tabLabel:'YOUTUBE'},
  {id:'fb', label:'Facebook',url:'https://cdn.simpleicons.org/facebook/1877F2', col:'#1877f2', tabBg:'#1877f2', tabTxt:'#fff', tabLabel:'FACEBOOK'},
  {id:'x',  label:'X',       url:'https://cdn.simpleicons.org/x/ffffff',        col:'#e0e0e0', tabBg:'#222',    tabTxt:'#fff', tabLabel:'X / TWITTER'},
  {id:'tt', label:'TikTok',  url:'https://cdn.simpleicons.org/tiktok/ffffff',   col:'#ff0050', tabBg:'#010101', tabTxt:'#ff0050', tabLabel:'TIKTOK'},
  {id:'kk', label:'Kick',    url:'https://cdn.simpleicons.org/kick/53FC18',     col:'#53fc18', tabBg:'#53fc18', tabTxt:'#000', tabLabel:'KICK'},
  {id:'tw', label:'Twitch',  url:'https://cdn.simpleicons.org/twitch/9146FF',   col:'#9146ff', tabBg:'#9146ff', tabTxt:'#fff', tabLabel:'TWITCH'},
];

const iconInner=document.getElementById('icon-inner');
ICONS.forEach(ic=>{
  const img=document.createElement('img');
  img.className='sicon'; img.src=ic.url; img.alt=ic.label; img.id='si-'+ic.id;
  iconInner.appendChild(img);
});

let curIcon=0;
document.querySelectorAll('.sicon')[0].classList.add('active');

/* Platform tab â€” smart: only shows at random intervals while icon is active */
const platTab=document.getElementById('plat-tab');
let tabTimer=null;

function hidePlatTab(){
  platTab.style.opacity='0';
  clearTimeout(tabTimer);
}
function showPlatTabForIcon(ic){
  clearTimeout(tabTimer);
  // Random delay before showing (2â€“8s after icon switch)
  const showDelay=2000+Math.random()*6000;
  tabTimer=setTimeout(()=>{
    platTab.textContent=ic.tabLabel;
    platTab.style.background=ic.tabBg;
    platTab.style.color=ic.tabTxt;
    platTab.style.opacity='1';
    // auto-hide after 2.5â€“5s
    tabTimer=setTimeout(()=>{
      platTab.style.opacity='0';
      // maybe show again once more while this icon is active
      const reshowDelay=3000+Math.random()*5000;
      tabTimer=setTimeout(()=>{
        if(ICONS[curIcon].id===ic.id){
          platTab.style.opacity='1';
          tabTimer=setTimeout(()=>{ platTab.style.opacity='0'; }, 2000+Math.random()*2000);
        }
      }, reshowDelay);
    }, 2500+Math.random()*2500);
  }, showDelay);
}

function rotateIcon(){
  const imgs=document.querySelectorAll('.sicon');
  const prev=imgs[curIcon];
  let next=curIcon;
  while(next===curIcon) next=Math.floor(Math.random()*ICONS.length);
  curIcon=next;
  prev.classList.remove('active'); prev.classList.add('exit');
  setTimeout(()=>prev.classList.remove('exit'),480);
  imgs[curIcon].classList.add('active');
  const ic=ICONS[curIcon];
  sv('--glow',ic.col); sv('--accent',ic.col); sv('--outline',ic.col);
  hidePlatTab();
  showPlatTabForIcon(ic);
  morphTextStyle(ic.col);
  setGlassTarget(ic.col);
  document.getElementById('sub-lbl').style.color=ic.col;
}
(function schedIcon(){ setTimeout(()=>{ rotateIcon(); schedIcon(); },2800+Math.random()*3200); })();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-C  LETTER INJECTION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const handleEl=document.getElementById('handle');
'MILIVYATAN'.split('').forEach((ch,i)=>{
  const s=document.createElement('span');
  s.className='lt'; s.textContent=ch;
  s.style.animation=`ltFadeIn .6s cubic-bezier(.22,1,.36,1) ${i*.07}s both`;
  handleEl.appendChild(s);
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-TEXT  4 STYLE MODES â€” black-focused
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const TEXT_STYLES=[
  // 0. Black matte â€” deep emboss
  (acc)=>{ const a=parseColor(acc); return {col:'#0a0a0a',strk:'1.5px rgba(255,255,255,.45)',sh:`0 1px 0 rgba(255,255,255,.65), 0 2px 6px rgba(0,0,0,.7), 0 0 10px rgba(${a.r},${a.g},${a.b},.18)`}; },
  // 1. Neon vivid â€” accent glow
  (acc)=>{ const a=parseColor(acc); return {col:acc,strk:'1.5px rgba(0,0,0,.7)',sh:`0 0 8px ${acc}, 0 0 22px ${acc}, 0 0 52px rgba(${a.r},${a.g},${a.b},.50), 2px 2px 0 rgba(0,0,0,.85)`}; },
  // 2. Flat clean dark â€” minimal shadow
  (acc)=>{ return {col:'#111',strk:'1px rgba(0,0,0,.08)',sh:`1px 1px 0 rgba(255,255,255,.7), -1px -1px 0 rgba(0,0,0,.12), 0 2px 4px rgba(0,0,0,.42)`}; },
  // 3. Soft luminous dark â€” faint aura
  (acc)=>{ const a=parseColor(acc); return {col:'#0d0d0d',strk:'1px rgba(255,255,255,.33)',sh:`0 1px 0 rgba(255,255,255,.5), 0 0 18px rgba(${a.r},${a.g},${a.b},.22), 0 3px 8px rgba(0,0,0,.62)`}; },
];

let textStyleIdx=0;
function morphTextStyle(acc){
  const st=TEXT_STYLES[textStyleIdx%TEXT_STYLES.length](acc||'#00ffa3');
  document.querySelectorAll('.lt').forEach(l=>{
    l.style.color=st.col;
    l.style.webkitTextStroke=st.strk;
    l.style.textShadow=st.sh;
  });
  sv('--text-col',st.col);
  const fb=document.getElementById('follow-btn');
  // follow button text color from text-col
  if(fb){ fb.style.background=acc||'#00ffa3'; fb.style.boxShadow=`0 0 10px ${acc||'#00ffa3'}`; }
}
function advanceTextStyle(acc){ textStyleIdx=(textStyleIdx+1)%TEXT_STYLES.length; morphTextStyle(acc); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-IRL  IRL SUBTEXT ROTATION
   Bold, premium IRL messaging. Rotates every 5â€“8 seconds.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const IRL_SUBS=[
  'REAL WORLD. REAL TIME.',
  'LIVE FROM LAGOS',
  'NO SCRIPT. JUST LIFE.',
  'BUILT IN PUBLIC',
  'STREAMING THE UNPREDICTABLE',
  'EXPERIMENT IN MOTION',
  'CHAOS IN 1080P',
  'WATCH THE RISE',
  'OUTSIDE > INSIDE',
  'EMPIRE IN PROGRESS',
  'SIGNAL OVER STREETS',
  'UNFILTERED. UNCUT. LIVE.',
];
let subIdx=0;
const subLbl=document.getElementById('sub-lbl');
(function schedSub(){
  setTimeout(()=>{
    subIdx=(subIdx+1)%IRL_SUBS.length;
    subLbl.style.opacity='0';
    setTimeout(()=>{
      subLbl.textContent=IRL_SUBS[subIdx];
      subLbl.style.opacity='.82';
    },350);
    schedSub();
  }, 5000+Math.random()*3000);
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-LIQUID  BLOB CANVAS â€” simplified, fewer blobs
   Only 6 blobs max. Wave sweep simplified.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const liquidCv  =document.getElementById('liquid-cv');
const liquidCtx =liquidCv.getContext('2d');

const BLOBS=Array.from({length:6},()=>({x:0,y:0,r:0,vx:0,vy:0,life:0,maxLife:0,active:false,color:'#00ffa3',alpha:0}));
let waveActive=false, waveProgress=0, waveColor='#00ffa3', warpTarget=0;
let liquidAny=false;

function spawnBlobs(acc){
  let spawned=0;
  BLOBS.forEach(b=>{
    if(b.active||spawned>=5) return;
    spawned++;
    const edge=Math.floor(Math.random()*4);
    if(edge===0){b.x=-20;b.y=Math.random()*BH;}
    else if(edge===1){b.x=BW+20;b.y=Math.random()*BH;}
    else if(edge===2){b.x=Math.random()*BW;b.y=-20;}
    else{b.x=Math.random()*BW;b.y=BH+20;}
    b.r=18+Math.random()*26; b.vx=(Math.random()-.5)*3.2; b.vy=(Math.random()-.5)*3.2;
    b.color=acc; b.alpha=.24+Math.random()*.28; b.life=0; b.maxLife=38+Math.random()*28; b.active=true;
  });
  waveActive=true; waveProgress=0; waveColor=acc;
  warpTarget=(Math.random()-.5)*3.5;
}

function animLiquid(){
  liquidCtx.clearRect(0,0,BW,BH);
  liquidAny=false;

  BLOBS.forEach(b=>{
    if(!b.active) return;
    liquidAny=true; b.life++;
    b.x+=b.vx; b.y+=b.vy; b.vx*=.93; b.vy*=.93; b.vy+=.028;
    const prog=b.life/b.maxLife;
    const rP=b.r*(1+Math.sin(prog*Math.PI)*.38);
    const fade=Math.sin(prog*Math.PI);
    liquidCtx.save();
    liquidCtx.globalAlpha=b.alpha*fade;
    const gl=liquidCtx.createRadialGradient(b.x,b.y,0,b.x,b.y,rP*2.2);
    gl.addColorStop(0,b.color+'bb'); gl.addColorStop(.55,b.color+'33'); gl.addColorStop(1,'transparent');
    liquidCtx.fillStyle=gl;
    liquidCtx.beginPath(); liquidCtx.arc(b.x,b.y,rP*2.2,0,Math.PI*2); liquidCtx.fill();
    const spd=Math.sqrt(b.vx*b.vx+b.vy*b.vy);
    const ang=Math.atan2(b.vy,b.vx);
    liquidCtx.translate(b.x,b.y); liquidCtx.rotate(ang);
    liquidCtx.scale(1+spd*.05,1/(1+spd*.05));
    const core=liquidCtx.createRadialGradient(0,0,0,0,0,rP);
    core.addColorStop(0,'#fff'); core.addColorStop(.28,b.color); core.addColorStop(1,b.color+'00');
    liquidCtx.fillStyle=core;
    liquidCtx.beginPath(); liquidCtx.arc(0,0,rP,0,Math.PI*2); liquidCtx.fill();
    liquidCtx.restore();
    if(b.life>=b.maxLife) b.active=false;
  });

  if(waveActive){
    liquidAny=true;
    waveProgress+=.026;
    if(waveProgress<1.2){
      const front=waveProgress*(BW+60)-30;
      const ww=80+BW*.09;
      const fade=Math.max(0,1-waveProgress*.82);
      const {r,g,b:bv}=parseColor(waveColor);
      liquidCtx.save();
      liquidCtx.globalAlpha=.15*fade;
      liquidCtx.beginPath();
      const amp=4, freq=(2*Math.PI)/(BH*.7);
      liquidCtx.moveTo(front,0);
      for(let y=0;y<=BH;y+=3){
        liquidCtx.lineTo(front+Math.sin(y*freq*3+waveProgress*8)*amp, y);
      }
      liquidCtx.lineTo(front-ww,BH); liquidCtx.lineTo(front-ww,0); liquidCtx.closePath();
      const wg=liquidCtx.createLinearGradient(front-ww,0,front+20,0);
      wg.addColorStop(0,`rgba(${r},${g},${bv},0)`);
      wg.addColorStop(.6,`rgba(${r},${g},${bv},.6)`);
      wg.addColorStop(1,`rgba(255,255,255,.8)`);
      liquidCtx.fillStyle=wg; liquidCtx.fill(); liquidCtx.restore();
      // subtle text-zone warp during wave
      const wAmt=Math.sin(waveProgress*Math.PI)*warpTarget;
      document.getElementById('text-zone').style.transform=`translateX(${wAmt.toFixed(2)}px)`;
    } else {
      waveActive=false;
      document.getElementById('text-zone').style.transform='';
    }
  }

  liquidCv.style.opacity=liquidAny?'1':'0';
  requestAnimationFrame(animLiquid);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-BG  UNIFIED BG CANVAS â€” geo shapes + particles in one loop
   Reduced: 14 geo shapes, 24 particles. Single canvas.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const bgCv =document.getElementById('bg-cv');
const bgCtx=bgCv.getContext('2d');

// cached accent for canvas loops â€” updated when accent changes
let cachedAccent='#00ffa3';

const GEO=Array.from({length:14},()=>({
  x:Math.random()*BW, y:Math.random()*BH,
  sz:8+Math.random()*18,
  type:['X','O','â–¡','â—‡'][Math.floor(Math.random()*4)],
  rot:Math.random()*Math.PI*2,
  vx:(Math.random()-.5)*.25, vy:(Math.random()-.5)*.25,
  vr:(Math.random()-.5)*.009,
  a:.16+Math.random()*.42,
}));

const PARTS=Array.from({length:24},()=>({
  x:Math.random()*BW, y:Math.random()*BH,
  r:.5+Math.random()*2,
  vx:(Math.random()-.5)*.4, vy:-.22-Math.random()*.38,
  a:.12+Math.random()*.5,
  life:Math.random(), ml:.3+Math.random()*.7,
}));

let _bgTick=0;
(function animBG(t=0){
  requestAnimationFrame(animBG);
  // Throttle bg canvas to ~30fps on streaming PCs (skip every other frame)
  if(++_bgTick%2!==0) return;
  bgCtx.clearRect(0,0,BW,BH);
  const col=cachedAccent;

  // Geo shapes â€” drawn every frame but computed every 2nd (position-only on off frames)
  GEO.forEach(s=>{
    s.x+=s.vx; s.y+=s.vy; s.rot+=s.vr;
    if(s.x<-30)s.x=BW+10; if(s.x>BW+10)s.x=-30;
    if(s.y<-30)s.y=BH+10; if(s.y>BH+10)s.y=-30;
    bgCtx.save();
    bgCtx.translate(s.x,s.y); bgCtx.rotate(s.rot);
    bgCtx.globalAlpha=s.a*(.5+.5*Math.sin(t*.001+s.x*.02));
    bgCtx.strokeStyle=col; bgCtx.lineWidth=1.4;
    const h=s.sz*.4;
    if(s.type==='X'){bgCtx.beginPath();bgCtx.moveTo(-h,-h);bgCtx.lineTo(h,h);bgCtx.moveTo(h,-h);bgCtx.lineTo(-h,h);bgCtx.stroke();}
    else if(s.type==='O'){bgCtx.beginPath();bgCtx.arc(0,0,h,0,Math.PI*2);bgCtx.stroke();}
    else if(s.type==='â–¡'){bgCtx.strokeRect(-h,-h,h*2,h*2);}
    else{bgCtx.beginPath();bgCtx.moveTo(0,-h);bgCtx.lineTo(h,0);bgCtx.lineTo(0,h);bgCtx.lineTo(-h,0);bgCtx.closePath();bgCtx.stroke();}
    bgCtx.restore();
  });

  // Particles
  PARTS.forEach(p=>{
    p.x+=p.vx; p.y+=p.vy; p.life+=.0038;
    if(p.life>p.ml||p.y<-5||p.x<-5||p.x>BW+5){
      p.x=Math.random()*BW; p.y=BH+4; p.life=0;
      p.vx=(Math.random()-.5)*.44; p.vy=-.22-Math.random()*.38;
      p.a=.12+Math.random()*.48;
    }
    const fade=1-p.life/p.ml;
    bgCtx.save(); bgCtx.globalAlpha=p.a*fade;
    const g=bgCtx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*3.4);
    g.addColorStop(0,col); g.addColorStop(1,'transparent');
    bgCtx.fillStyle=g;
    bgCtx.beginPath(); bgCtx.arc(p.x,p.y,p.r*3.4,0,Math.PI*2); bgCtx.fill();
    bgCtx.restore();
  });
})(0);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-D  GLITCH â€” liquid warp, no opacity-0
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const rgbGhost=document.getElementById('rgb-ghost');
function triggerGlitch(dur=560){
  document.querySelectorAll('.lt').forEach(l=>{
    if(Math.random()<.6){
      l.style.animation=`liquidWarp ${dur*1.1}ms cubic-bezier(.22,1,.36,1) both`;
      setTimeout(()=>{ l.style.animation=''; morphTextStyle(cachedAccent); }, dur*1.1+80);
    }
  });
  rgbGhost.style.animation=`rgbSplitWave ${dur*.85}ms cubic-bezier(.22,1,.36,1) both`;
  setTimeout(()=>{ rgbGhost.style.animation=''; rgbGhost.style.opacity='0'; }, dur*.85+30);
  if(liquidAny||Math.random()>.4) spawnBlobs(cachedAccent);
  glass.tgt.blur=glass.cur.blur+5;
  setTimeout(()=>{ glass.tgt.blur=glass.cur.blur>16?16:glass.cur.blur+2; }, dur*.5);
}
(function schedGlitch(){ setTimeout(()=>{ triggerGlitch(500+Math.random()*400); schedGlitch(); }, 5000+Math.random()*7000); })();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-E  PALETTE CYCLE â€” no bgVanish, glass tween handles all
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PALETTES=[
  {acc:'#00ffa3',out:'#00ffa3'},{acc:'#ff2d78',out:'#ff2d78'},
  {acc:'#ffd700',out:'#ffd700'},{acc:'#00f7ff',out:'#00f7ff'},
  {acc:'#9146ff',out:'#b97eff'},{acc:'#53fc18',out:'#53fc18'},
  {acc:'#ff6b00',out:'#ff9500'},{acc:'#e0e0e0',out:'#cccccc'},
];
let palIdx=0;
(function schedBg(){
  setTimeout(()=>{
    palIdx=(palIdx+1)%PALETTES.length;
    const p=PALETTES[palIdx];
    sv('--accent',p.acc); sv('--outline',p.out); sv('--glow',p.acc);
    BANNER.style.borderColor=p.out;
    cachedAccent=p.acc;
    if(palIdx%2===0) advanceTextStyle(p.acc); else morphTextStyle(p.acc);
    document.getElementById('sub-lbl').style.color=p.acc;
    setGlassTarget(p.acc);
    spawnBlobs(p.acc);
    if(Math.random()<.45) triggerDrip(p.acc);
    schedBg();
  }, 9000+Math.random()*9000);
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-F  LETTER BOUNCE/POP/FLICKER
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LETTER_ANIMS=['ltBounce','ltPop','ltFlicker'];
(function schedBounce(){
  setTimeout(()=>{
    const lts=document.querySelectorAll('.lt');
    const cnt=1+Math.floor(Math.random()*3);
    const used=new Set();
    for(let k=0;k<cnt;k++){
      let i=Math.floor(Math.random()*lts.length);
      while(used.has(i))i=Math.floor(Math.random()*lts.length);
      used.add(i);
      setTimeout(()=>{
        lts[i].style.animation=`${LETTER_ANIMS[Math.floor(Math.random()*3)]} .78s cubic-bezier(.34,1.56,.64,1) both`;
        setTimeout(()=>{ lts[i].style.animation=''; morphTextStyle(cachedAccent); },860);
      },k*100);
    }
    schedBounce();
  },1200+Math.random()*2400);
})();
setTimeout(()=>morphTextStyle('#00ffa3'),900);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-G  STYLE PRESETS â€” 7 only (removed grunge, minimal, social)
   Each preset morphs border-radius and glass only â€” no size change.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setFont(f){ triggerGlitch(320); setTimeout(()=>document.querySelectorAll('.lt').forEach(l=>l.style.fontFamily=f),180); }
const setLP    =(p,v)=>document.querySelectorAll('.lt').forEach(l=>l.style[p]=v);
const setSL    =v=>document.getElementById('scanlines').style.opacity=v;
const showFB   =()=>document.getElementById('follow-btn').classList.add('vis');
const hideFB   =()=>document.getElementById('follow-btn').classList.remove('vis');
const setIB    =(r,bg,bc)=>{ const el=document.getElementById('icon-bg'); if(r)el.style.borderRadius=r; if(bg)el.style.background=bg; if(bc)el.style.borderColor=bc; };

function setGlass(txtHex,accHex,overRgb){
  sv('--glow',accHex); sv('--outline',accHex); sv('--accent',accHex);
  cachedAccent=accHex;
  document.getElementById('sub-lbl').style.color=accHex;
  morphTextStyle(accHex);
  setGlassTarget(accHex,overRgb);
}
function triggerDrip(col){
  const d=document.getElementById('drip');
  d.style.background=col; d.style.opacity='.82';
  d.style.animation='dripIn 1.1s cubic-bezier(.22,1,.36,1) both';
  setTimeout(()=>{ d.style.animation=''; d.style.opacity='0'; },1160);
}
function triggerFlicker(){
  BANNER.style.filter='brightness(.82)';
  setTimeout(()=>{ BANNER.style.transition='filter 480ms cubic-bezier(.22,1,.36,1)'; BANNER.style.filter='brightness(1)'; },120);
  setTimeout(()=>{ BANNER.style.filter=''; BANNER.style.transition='border-radius 700ms cubic-bezier(.22,1,.36,1), border-color 700ms cubic-bezier(.22,1,.36,1), box-shadow 700ms cubic-bezier(.22,1,.36,1)'; },620);
}
function triggerPopEntrance(){
  document.querySelectorAll('.lt').forEach((l,i)=>{
    setTimeout(()=>{
      l.style.animation='ltPop .48s cubic-bezier(.34,1.56,.64,1) both';
      setTimeout(()=>{ l.style.animation=''; morphTextStyle(cachedAccent); },540);
    },i*62);
  });
}
function staggerFade(){
  document.querySelectorAll('.lt').forEach((l,i)=>{
    l.style.opacity='0'; l.style.transform='translateX(-7px) scale(.95)';
    setTimeout(()=>{
      l.style.transition='opacity 340ms cubic-bezier(.22,1,.36,1),transform 340ms cubic-bezier(.34,1.56,.64,1)';
      l.style.opacity='1'; l.style.transform='translateX(0) scale(1)';
    },30+i*106);
  });
}

// Sub-label override used by presets â€” restores IRL rotation after 8s
function presetSub(txt){
  subLbl.textContent=txt;
  subLbl.style.opacity='.82';
}

const PRESETS=[
  // 1. Glossy 3D Sticker â€” black matte text, thick border
  ()=>{
    setFont("'Bebas Neue',sans-serif");
    BANNER.style.borderRadius='10px'; BANNER.style.borderWidth='3px';
    presetSub('LIVE ON AIR'); setSL('0'); hideFB();
    setIB('10px','rgba(255,255,255,0.06)','rgba(255,255,255,0.22)');
    setGlass('#0a0a0a',cachedAccent,null);
  },
  // 2. Liquid Drip â€” Follow Now messaging
  ()=>{
    setFont("'Russo One',sans-serif");
    BANNER.style.borderRadius='48px'; BANNER.style.borderWidth='0px';
    presetSub('FOLLOW NOW'); setSL('0'); hideFB();
    setIB('50%','rgba(255,255,255,0.05)','rgba(255,255,255,0.12)');
    setTimeout(()=>triggerDrip(cachedAccent),220);
    setGlass('#0a0a0a',cachedAccent,null);
  },
  // 3. Unified Sticker Outline
  ()=>{
    setFont("'Exo 2',sans-serif");
    BANNER.style.borderRadius='12px'; BANNER.style.borderWidth='4px';
    presetSub('+ FOLLOW TODAY'); setSL('0'); hideFB();
    setIB('12px','rgba(255,255,255,0.06)','rgba(255,255,255,0.26)');
    triggerPopEntrance();
    setGlass('#0a0a0a',cachedAccent,null);
  },
  // 4. Kick Shark â€” green identity
  ()=>{
    setFont("'Orbitron',monospace");
    BANNER.style.borderRadius='6px'; BANNER.style.borderWidth='2px';
    BANNER.style.borderColor='#53fc18';
    presetSub('KICK GAMING âš¡'); setSL('.08'); hideFB();
    setIB('6px','rgba(0,26,0,.44)','rgba(83,252,24,.34)');
    setGlass('#062006','#53fc18',[2,18,1,.64]);
  },
  // 5. Legendary Content â€” gold brand
  ()=>{
    setFont("'Cinzel',serif");
    BANNER.style.borderRadius='0'; BANNER.style.borderWidth='2px';
    presetSub('LEGENDARY CONTENT'); setSL('.08'); hideFB();
    setIB('4px','rgba(26,0,16,.48)','rgba(180,120,0,.40)');
    setGlass('#1a0a00','#ffd700',[14,2,20,.66]);
  },
  // 6. Tabbed â€” Follow button visible, Twitch/Kick preset
  ()=>{
    setFont("'Chakra Petch',sans-serif");
    BANNER.style.borderRadius='0 8px 8px 8px'; BANNER.style.borderWidth='2px';
    presetSub('NEW STREAM ALERT'); setSL('0'); showFB();
    setIB('4px','rgba(0,16,0,.38)','rgba(83,252,24,.34)');
    setGlass('#060c02','#53fc18',[2,14,1,.56]);
  },
  // 7. Stagger Icon Lineup
  ()=>{
    setFont("'Bebas Neue',sans-serif");
    BANNER.style.borderRadius='6px'; BANNER.style.borderWidth='0px';
    presetSub('FOLLOW ALL PLATFORMS'); setSL('0'); hideFB();
    setIB('8px','rgba(255,255,255,0.05)','rgba(255,255,255,0.10)');
    staggerFade();
    setGlass('#0a0a0a',cachedAccent,null);
  },
];

PRESETS[0]();
let presetIdx=0;
(function schedPreset(){
  setTimeout(()=>{
    presetIdx=(presetIdx+1)%PRESETS.length;
    spawnBlobs(cachedAccent);
    triggerGlitch(400);
    setTimeout(()=>PRESETS[presetIdx](),220);
    schedPreset();
  }, 12000+Math.random()*10000);
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-J  DONATION MODE â€” opacity fade, fixed overlay
   No layout change. No flipResize. Display:flex always, opacity gates.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const donPanel=document.getElementById('donation-panel');
const coinCv  =document.getElementById('coin-cv');
const coinCtx =coinCv.getContext('2d');
let donActive =false;
const MONEY=['ğŸ’µ','ğŸ’°','ğŸª™','ğŸ’¸','ğŸ¤‘','ğŸ’´','ğŸ’¶'];

function spawnMoneyDrops(){
  document.querySelectorAll('.money-drop').forEach(el=>el.remove());
  for(let i=0;i<10;i++){
    const el=document.createElement('div'); el.className='money-drop';
    el.textContent=MONEY[Math.floor(Math.random()*MONEY.length)];
    el.style.cssText=`left:${5+Math.random()*(BW-20)}px;animation-duration:${2+Math.random()*2.5}s;animation-delay:${Math.random()*2}s;font-size:${10+Math.random()*8}px;`;
    donPanel.insertBefore(el,donPanel.firstChild);
  }
}

const COINS=Array.from({length:20},()=>({x:0,y:0,vx:0,vy:0,r:0,life:0,maxLife:0,active:false}));
function burstCoins(cx,cy){
  COINS.forEach(c=>{ if(!c.active){ c.x=cx;c.y=cy;c.active=true;c.life=0;c.maxLife=55+Math.random()*35; c.vx=(Math.random()-.5)*4.5;c.vy=-2.4-Math.random()*3.2;c.r=3+Math.random()*4.5; } });
}
function animCoins(){
  coinCtx.clearRect(0,0,BW,BH);
  COINS.forEach(c=>{
    if(!c.active) return;
    c.life++; c.vy+=.16; c.x+=c.vx; c.y+=c.vy;
    if(c.life>=c.maxLife){ c.active=false; return; }
    const fade=1-c.life/c.maxLife;
    coinCtx.save(); coinCtx.globalAlpha=fade;
    const gr=coinCtx.createRadialGradient(c.x,c.y,0,c.x,c.y,c.r);
    gr.addColorStop(0,'#fff8b0');gr.addColorStop(.4,'#ffd700');gr.addColorStop(1,'#b8860b');
    coinCtx.fillStyle=gr;
    coinCtx.beginPath();coinCtx.ellipse(c.x,c.y,c.r,c.r*.68,c.life*.04,0,Math.PI*2);coinCtx.fill();
    coinCtx.fillStyle='rgba(0,0,0,.55)';
    coinCtx.font=`bold ${c.r*1.1}px sans-serif`;
    coinCtx.textAlign='center';coinCtx.textBaseline='middle';
    coinCtx.fillText('$',c.x,c.y);
    coinCtx.restore();
  });
  if(donActive) requestAnimationFrame(animCoins);
  else coinCtx.clearRect(0,0,BW,BH);
}

let coinBurstTimer=null;
function enterDonation(){
  donActive=true;
  donPanel.style.animation='donEnter .6s cubic-bezier(.22,1,.36,1) both';
  donPanel.classList.add('vis');
  coinCv.style.opacity='1';
  spawnMoneyDrops();
  requestAnimationFrame(animCoins);
  burstCoins(80+Math.random()*(BW-160),20+Math.random()*(BH-40));
  coinBurstTimer=setInterval(()=>{ if(donActive) burstCoins(80+Math.random()*(BW-160),20+Math.random()*(BH-40)); },800);
}
function exitDonation(){
  donActive=false;
  donPanel.classList.remove('vis');
  donPanel.style.animation='';
  coinCv.style.opacity='0';
  clearInterval(coinBurstTimer);
  document.querySelectorAll('.money-drop').forEach(el=>el.remove());
}

function runDonationCycle(){
  enterDonation();
  setTimeout(()=>{ exitDonation(); setTimeout(runDonationCycle,28000+Math.random()*14000); }, 8000+Math.random()*3000);
}
setTimeout(runDonationCycle,18000);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-MEASURE  AUTO-WIDTH FROM LONGEST FONT
   Waits for all web fonts (document.fonts.ready), then measures
   "MILIVYATAN" in every font used by the preset rotation using an
   offscreen canvas.  Takes the widest result, adds fixed chrome
   (icon panel + padding + safety), and writes the final pixel
   value to --banner-w and BW before any visible animation runs.

   Fonts measured (all at 46px / weight 900 / letter-spacing 0.02em):
     Bebas Neue Â· Russo One Â· Exo 2 Â· Orbitron Â· Cinzel Â· Chakra Petch
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function measureAndApplyWidth() {
  // Respect a 2 s maximum â€” keeps SE preview from stalling on font timeout
  await Promise.race([
    document.fonts.ready,
    new Promise(r => setTimeout(r, 2000))
  ]);

  const TEXT         = 'MILIVYATAN';
  const FS           = 46;           // font-size px (matches .lt)
  const FW           = '900';        // font-weight
  const LS_EM        = 0.02;         // letter-spacing in em (matches .lt)
  const LS_PX        = FS * LS_EM;   // per-character extra spacing

  // Every font family set by setFont() across all 7 presets
  const FONT_FAMILIES = [
    "'Bebas Neue', sans-serif",
    "'Russo One', sans-serif",
    "'Exo 2', sans-serif",
    "'Orbitron', monospace",
    "'Cinzel', serif",
    "'Chakra Petch', sans-serif",
  ];

  // Offscreen canvas â€” wide enough for any measurement
  const mc  = document.createElement('canvas');
  mc.width  = 3000;
  mc.height = 120;
  const mx  = mc.getContext('2d');

  let maxTextW = 0;

  FONT_FAMILIES.forEach(family => {
    mx.font = `${FW} ${FS}px ${family}`;

    // Use native letterSpacing (Chrome 99+ / SE's Chromium) when available;
    // fall back to manual addition so we never under-measure.
    let measured;
    if ('letterSpacing' in mx) {
      mx.letterSpacing = `${LS_PX}px`;
      measured = mx.measureText(TEXT).width;
      mx.letterSpacing = '0px';
    } else {
      // Fallback: measure each glyph individually and sum with spacing
      let total = 0;
      for (const ch of TEXT) total += mx.measureText(ch).width;
      total += LS_PX * TEXT.length; // letter-spacing applies after every char
      measured = total;
    }

    if (measured > maxTextW) maxTextW = measured;
  });

  // Add 1 extra character-width of letter-spacing that CSS applies
  // after the last char (CSS letter-spacing pads both sides of each glyph,
  // so the last gap is already baked in by measureText â€” no extra needed).

  // Fixed chrome (pixels):
  //   icon-wrap        : 84 px  (width declared in CSS, flex-shrink:0)
  //   text-zone pad-L  :  4 px
  //   text-zone pad-R  : 10 px
  //   max border-width :  4 px Ã— 2 sides = 8 px (Preset 3 uses 4px)
  //   safety buffer    : 14 px  (letter pop/bounce can overshoot slightly)
  const CHROME = 84 + 4 + 10 + 8 + 14;

  const newBW = Math.ceil(maxTextW + CHROME);

  // Only update if the measurement is plausible (font loaded properly)
  if (newBW < 300 || newBW > 1400) return; // guard against measurement failure

  // 1. Update JS constant used by all canvas loops
  BW = newBW;

  // 2. Update CSS variable â†’ html/body, #banner, and canvas CSS widths all follow
  document.documentElement.style.setProperty('--banner-w', BW + 'px');

  // 3. Resize canvas drawing buffers (CSS width already follows --banner-w)
  [bgCv, liquidCv, coinCv].forEach(cv => { cv.width = BW; });

  // 4. Reposition any live GEO shapes that fell outside the new boundary
  GEO.forEach(s => { if (s.x > BW) s.x = Math.random() * BW; });
  PARTS.forEach(p => { if (p.x > BW) p.x = Math.random() * BW; });

  console.log(`%c[MILIVYATAN] Width measured: ${BW}px (text ${Math.round(maxTextW)}px + chrome ${CHROME}px)`,
    'color:#0a0a0a;background:#00ffa3;padding:2px 8px;border-radius:3px;font-size:11px');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-K  MASTER rAF LOOP â€” single loop for glassTween
   All canvas systems have their own rAF already.
   This loop ONLY handles glassTween to avoid redundant rAFs.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function masterLoop(){ glassFrame(); requestAnimationFrame(masterLoop); })();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Â§JS-BOOT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
setGlassTarget('#00ffa3');
glass.cur.r=12;glass.cur.g=12;glass.cur.b=12;glass.cur.a=.52;
subLbl.textContent=IRL_SUBS[0];
animLiquid();
setTimeout(microDeform,3500);
setTimeout(()=>morphTextStyle('#00ffa3'),900);

// Â§JS-MEASURE â€” measure longest font and lock banner width
// Runs async; resolves before first preset switch (fonts load in ~100ms on SE)
measureAndApplyWidth();

// Follow btn click
document.getElementById('follow-btn').addEventListener('click',()=>{
  const b=document.getElementById('follow-btn');
  b.textContent='âœ” FOLLOWING'; b.style.background='#00ff80';
  setTimeout(()=>b.textContent='+ FOLLOW',2800);
});

console.log('%c[MILIVYATAN IRL] âœ“ StreamElements ready â€” width auto-measured from fonts','color:#0a0a0a;font-weight:bold;font-size:12px;background:#00ffa3;padding:4px 12px;border-radius:4px');
</script>
</body>
</html>
